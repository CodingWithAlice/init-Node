<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>reduce相关用例</title>
</head>

<body>
    <script>
        // 简单了解 reduce
        // const array1 = [1, 2, 3, 4];
        // const reducer = (pre, cur) => {
        //     console.log(pre, cur);
        //     return pre + cur;
        // }
        // let res = array1.reduce(reducer, 5);

        // 按属性对Object进行分类
        // var arr = [{ name: 'Max', age: 21 }, { name: 'Max', age: 20 }, { name: 'Jane', age: 20 }];

        // function groupBy(array, property) {
        //     return array.reduce((pre, cur) => {
        //         // 取 age 属性的值作为对象 pre 的 key 值
        //         var key = cur[property];
        //         // 在 pre 数组中以 key 值分类
        //         if (!pre[key]) {
        //             pre[key] = [];
        //         }
        //         pre[key].push(cur);
        //         // 将 pre 传递
        //         return pre;
        //     }, {});
        // }

        // var res = groupBy(arr, 'name');

        // 按序运行Promise
        function runPromiseInSequence(arr, input) {
            return arr.reduce(
                (pre, cur) => {
                    console.log('pre=', pre);
                    console.log('cur=', cur);
                    return pre.then(cur)
                }, // reducer
                Promise.resolve(input) // initialValue
            );
        }

        let p1 = a => new Promise((resolve, reject) => {
            resolve(a * 1);
        });

        let p2 = a => new Promise((resolve, reject) => {
            resolve(a * 2);
        });

        let f3 = a => a * 3;

        let p4 = a => new Promise((resolve, reject) => {
            resolve(a * 4);
        });

        const promiseArr = [p1, p2, f3, p4];
        runPromiseInSequence(promiseArr, 1)
            .then((res) => {
                console.log(res);
            });
    </script>
</body>

</html>